<app-menu></app-menu>

<div class="separador"></div>

<div style="padding-top: 5.4em; margin-left: 5%;" *ngIf="subcategory.category">
  <a routerLink="/categoria/{{ subcategory.category.id }}" style="color: grey;">
    <mat-icon class="volver" style="font-size:2em ;">keyboard_backspace</mat-icon>
  </a>
</div>

<form class="example-form">
  <mat-form-field class="example-full-width" appearance="outline">
    <mat-label>Encuentra el foro que buscas</mat-label>
    <input
      type="text"
      placeholder="Busca un foro"
      aria-label="Number"
      matInput
      [formControl]="myControl"
      [matAutocomplete]="auto"
    />
    <mat-autocomplete #auto="matAutocomplete">
      <mat-option
        *ngFor="let option of filteredForums | async"
        [value]="option.title"
        ><a routerLink="/foro/{{ option.id }}" style="color: black;">
          {{ option.title }}
        </a>
      </mat-option>
    </mat-autocomplete>
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>
</form>

<div *ngFor="let cont of subcategory.contentSubcategories">
  <mat-card class="example-card container head">
    <mat-card-title class="top">{{ subcategory.name }}</mat-card-title>
    <img mat-card-image [src]="subcategory.image" class="encabezado" />

    <strong>
      <mat-card-content>
        <mat-card-title style="justify-content: left;"
          ><strong
            >Recomendación Wave:
            <br />
            {{ subcategory.contentSubcategories[0].title }}</strong
          ></mat-card-title
        >
        <p>
          {{ subcategory.contentSubcategories[0].text }}
        </p>
        <br />
        <p>
          Consigue más en:
          <a href="{{ subcategory.contentSubcategories[0].link }}"
            >Contenido extra</a
          >
        </p>
      </mat-card-content>
    </strong>
  </mat-card>
</div>

<div *ngIf="isFav(subcategoryId)">
  <a
    class="btn btn-primary abajo"
    style="color: white;"
    data-toggle="modal"
    data-target="#exampleModal"
  >
    crear foro
  </a>
</div>
<div *ngIf="!isFav(subcategoryId)">
  <button class="btn btn-primary abajo" (click)="agregarFavorito()">
    suscribirse
  </button>
</div>

<div *ngIf="subscribedForums.length > 0">
  <hr />
  <h4>Ya estas suscrito en estos foros</h4>
  <br />

  <div></div>

  <div *ngFor="let foro of subscribedForums" class="foros">
    <a routerLink="/foro/{{ foro.id }}"
      ><mat-card class="foros1">
        <div
          *ngIf="foro.image != null && foro.image != undefined; else sinFoto"
          class="ordenar"
        >
          <img mat-card-avatar [src]="foro.image" alt="User Avatar" />
          <p style="align-self: center;">
            {{ foro.title }}
          </p>
        </div>
        <ng-template #sinFoto>
          <div class="ordenar">
            <img
              mat-card-avatar
              src="https://mustdonewzealand.co.nz/wp-content/uploads/2013/08/white-300x225.jpg"
              alt="User Avatar"
            />
            <p style="align-self: center;">
              {{ foro.title }}
            </p>
          </div>
        </ng-template>
      </mat-card></a
    >
  </div>
</div>
<hr />
<h4>También puedes participar en estos foros</h4>
<br />

<div></div>

<div *ngFor="let foro of favoriteForums" class="foros">
  <div *ngIf="!isSuscribed(foro.id)">
  <a routerLink="/foro/{{ foro.id }}"
    ><mat-card class="foros1"
      ><div
        *ngIf="foro.image != null && foro.image != undefined; else sinFoto"
        class="ordenar"
      >
        <img mat-card-avatar [src]="foro.image" alt="User Avatar" />
        <p style="align-self: center;">{{ foro.title }}</p>
      </div>
      <ng-template #sinFoto>
        <div class="ordenar">
          <img
            mat-card-avatar
            src="https://www.liberaldictionary.com/wp-content/uploads/2019/02/f-8273.jpg"
            alt="User Avatar"
          />
          <p style="align-self: center;">{{ foro.title }}</p>
        </div>
      </ng-template>
    </mat-card></a
  ></div>
</div>

<button
  *ngIf="nextPage"
  (click)="traerMasForos()"
  type="button"
  class="btn btn-mas"
>
  Traer mas foros
</button>

<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          <strong>¡Crea un foro!</strong>
        </h5>
        <button
          type="button"
          class="close"
          (click)="reset()"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <form [formGroup]="forumForm">
          <mat-form-field>
            <mat-label>Nombre del foro</mat-label>
            <input
              [(ngModel)]="comment"
              formControlName="text"
              matInput
              name="text"
              placeholder="Nombre"
            />
          </mat-form-field>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn" (click)="reset()" data-dismiss="modal">
          cancelar
        </button>

        <button
          [disabled]="forumForm.invalid"
          (click)="onSaveForm()"
          class="btn"
          data-dismiss="modal"
        >
          continuar
        </button>
      </div>
    </div>
  </div>
</div>
